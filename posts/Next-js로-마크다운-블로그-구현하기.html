<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="description" content="yes-xodnd의 기술 블로그입니다."/><meta name="keywords" content="blog, frontend, javascript, css, html"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-f187076f129739963abb.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.e3de07479da4f2477dea.js" as="script"/><link rel="preload" href="/_next/static/chunks/365e2c93ee4512644b764144cea69ab374a79a06.3b920c3faddc10506db9.js" as="script"/><link rel="preload" href="/_next/static/chunks/24220ea1bbf29512b490391fd78ed8994ffe83b7.e749a8624d972ec43ecc.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-45233f10ca9edf78efdb.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-34016f798fe4617dc9a3.js" as="script"/><style data-styled="" data-styled-version="5.2.1">@media (max-width:768px){:root{font-size:12px;}}/*!sc*/
body{margin:auto;padding:0;box-sizing:border-box;}/*!sc*/
a{color:black;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
a:visited{color:inherit;}/*!sc*/
data-styled.g1[id="sc-global-ijJdKq1"]{content:"sc-global-ijJdKq1,"}/*!sc*/
.hnTQNm{list-style:none;margin:0;}/*!sc*/
data-styled.g2[id="Nav__List-sc-1mo3uz2-0"]{content:"hnTQNm,"}/*!sc*/
.eDGlRG{display:inline-block;margin-left:1rem;}/*!sc*/
data-styled.g3[id="Nav__ListItem-sc-1mo3uz2-1"]{content:"eDGlRG,"}/*!sc*/
.jmUXdQ{border-bottom:1px solid black;}/*!sc*/
data-styled.g4[id="Header__Container-sc-13fiemu-0"]{content:"jmUXdQ,"}/*!sc*/
.kIYQjf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:2rem;margin:auto;max-width:1024px;}/*!sc*/
data-styled.g5[id="Header__Content-sc-13fiemu-1"]{content:"kIYQjf,"}/*!sc*/
.eHAsYS{padding:1.5rem 2rem;color:grey;text-align:center;font-size:0.8rem;}/*!sc*/
data-styled.g6[id="Footer__Container-qhytvz-0"]{content:"eHAsYS,"}/*!sc*/
.bUsZOM{margin:auto;max-width:1024px;}/*!sc*/
data-styled.g7[id="Footer__Content-qhytvz-1"]{content:"bUsZOM,"}/*!sc*/
.koMWLo{position:fixed;right:3rem;bottom:3rem;width:2rem;height:2rem;border-radius:2px;border:1px solid black;background:white;visibility:visible;-webkit-transition:200ms;transition:200ms;}/*!sc*/
.koMWLo:hover{cursor:pointer;}/*!sc*/
data-styled.g8[id="ButtonScrollUp__Button-sc-1ue24uv-0"]{content:"koMWLo,"}/*!sc*/
.ddsaFJ{max-width:1024px;margin:3rem auto 10rem;}/*!sc*/
data-styled.g9[id="Layout__Main-sc-1l83v77-0"]{content:"ddsaFJ,"}/*!sc*/
.jDWHvN{margin:auto;padding:0 2rem;max-width:768px;}/*!sc*/
data-styled.g10[id="slug__Container-sc-1egli5l-0"]{content:"jDWHvN,"}/*!sc*/
.jjmFNC{border-left:0.5rem solid cornflowerblue;padding:0 2rem;margin-bottom:3rem;}/*!sc*/
data-styled.g11[id="slug__Header-sc-1egli5l-1"]{content:"jjmFNC,"}/*!sc*/
.kYNJsK{margin:0;margin-bottom:1rem;font-size:1.6rem;}/*!sc*/
data-styled.g12[id="slug__Title-sc-1egli5l-2"]{content:"kYNJsK,"}/*!sc*/
.dEtgjY{font-size:0.8rem;}/*!sc*/
data-styled.g13[id="slug__Date-sc-1egli5l-3"]{content:"dEtgjY,"}/*!sc*/
.hwqDSy{line-height:1.8rem;}/*!sc*/
.hwqDSy a{color:cornflowerblue;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.hwqDSy a:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.hwqDSy a:visited{color:cornflowerblue;}/*!sc*/
.hwqDSy img{display:block;width:90%;margin:2rem auto;padding:1rem;border:1px solid rgb(245,245,245);}/*!sc*/
.hwqDSy h2{margin-top:5rem;}/*!sc*/
.hwqDSy h3{margin-top:3rem;}/*!sc*/
.hwqDSy code:not([class]){padding:0.2rem 0.4rem;background-color:rgb(245,245,245);border-radius:3px;}/*!sc*/
.hwqDSy blockquote{margin:0;padding:0.5rem 2rem 0.5rem;border-left:3px solid cornflowerblue;border-radius:3px;background:rgb(245,245,245);font-size:0.8rem;}/*!sc*/
.hwqDSy code[class*="language-"],.hwqDSy pre[class*="language-"]{color:#000;background:none;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.6;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}/*!sc*/
.hwqDSy code[class*="language-"]::-webkit-scrollbar,.hwqDSy pre[class*="language-"]::-webkit-scrollbar{height:3px;}/*!sc*/
.hwqDSy code[class*="language-"]::-webkit-scrollbar-thumb,.hwqDSy pre[class*="language-"]::-webkit-scrollbar-thumb{background-color:#ccc;}/*!sc*/
.hwqDSy pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto;}/*!sc*/
.hwqDSy:not(pre) > code[class*="language-"],.hwqDSy pre[class*="language-"]{background:#f9f9f9;}/*!sc*/
.hwqDSy:not(pre) > code[class*="language-"]{padding:.1em;border-radius:.3em;white-space:normal;}/*!sc*/
.hwqDSy .token.comment,.hwqDSy .token.block-comment,.hwqDSy .token.prolog,.hwqDSy .token.doctype,.hwqDSy .token.cdata{color:slategray;}/*!sc*/
.hwqDSy .token.punctuation{color:#999;}/*!sc*/
.hwqDSy .token.tag,.hwqDSy .token.attr-name,.hwqDSy .token.namespace,.hwqDSy .token.deleted{color:#e2777a;}/*!sc*/
.hwqDSy .token.function-name{color:#6196cc;}/*!sc*/
.hwqDSy .token.boolean,.hwqDSy .token.number,.hwqDSy .token.function{color:#ed782b;}/*!sc*/
.hwqDSy .token.property,.hwqDSy .token.class-name,.hwqDSy .token.constant,.hwqDSy .token.symbol{color:#dea702;}/*!sc*/
.hwqDSy .token.selector,.hwqDSy .token.important,.hwqDSy .token.atrule,.hwqDSy .token.keyword,.hwqDSy .token.builtin{color:#bb60bd;}/*!sc*/
.hwqDSy .token.string,.hwqDSy .token.char,.hwqDSy .token.attr-value,.hwqDSy .token.regex,.hwqDSy .token.variable{color:#2bba61;}/*!sc*/
.hwqDSy .token.operator,.hwqDSy .token.entity,.hwqDSy .token.url{color:#67cdcc;}/*!sc*/
.hwqDSy .token.important,.hwqDSy .token.bold{font-weight:bold;}/*!sc*/
.hwqDSy .token.italic{font-style:italic;}/*!sc*/
.hwqDSy .token.entity{cursor:help;}/*!sc*/
.hwqDSy .token.inserted{color:green;}/*!sc*/
data-styled.g14[id="slug__Content-sc-1egli5l-4"]{content:"hwqDSy,"}/*!sc*/
</style></head><body><div id="__next"><header class="Header__Container-sc-13fiemu-0 jmUXdQ"><div class="Header__Content-sc-13fiemu-1 kIYQjf"><a href="/">YES-XODND BLOG.</a><nav><ul class="Nav__List-sc-1mo3uz2-0 hnTQNm"><li class="Nav__ListItem-sc-1mo3uz2-1 eDGlRG"><a href="/">HOME</a></li><li class="Nav__ListItem-sc-1mo3uz2-1 eDGlRG"><a href="/posts">POSTS</a></li></ul></nav></div></header><main class="Layout__Main-sc-1l83v77-0 ddsaFJ"><section class="slug__Container-sc-1egli5l-0 jDWHvN"><div class="slug__Header-sc-1egli5l-1 jjmFNC"><h1 class="slug__Title-sc-1egli5l-2 kYNJsK">next.js로 마크다운 블로그 구현하기</h1><div class="slug__Date-sc-1egli5l-3 dEtgjY">Apr 11, 2021</div></div><article class="slug__Content-sc-1egli5l-4 hwqDSy"><p>기술 블로그를 운영하기 위해 여러가지 서비스를 찾아다니다가, github pages를 통해 호스팅되는 개발자 블로그를 많이 보게 되었습니다. Jekyll이라는 정적 사이트 생성기를 이용하면 5분 만에 블로그를 만들 수 있다는 글들이 많아 혹했으나, 프론트엔드 개발자로서 직접 만들어보고 싶다는 생각을 하게 되었습니다.</p>
<p>Next를 이용하면 마크다운 정적 블로그를 구현할 수 있다는 것을 알게 되어 이번 기회에 학습과 토이 프로젝트 진행, 기술 블로그 제작까지 세 마리 토끼를 한 번에 잡아보고자 하였습니다.</p>
<h2>초기 설정</h2>
<p><code>create-next-app</code>을 사용하지 않고, 필요한 요소들을 하나씩 manual setup을 해보기로 했습니다.
<code>next.config.js</code> 파일이 없지만 next에서 기본 설정을 사용합니다.</p>
<h3>npm 패키지 설치</h3>
<p>Next 공식 홈페이지의 설명을 따라 React와 Next를 설치합니다.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> next react react-dom
</code></pre></div>
<p>프로젝트 폴더에는 <code>node-modules</code>폴더와 <code>package.json</code>, <code>package-lock.json</code> 두 개의 기본적인 json 파일이 생성되었습니다.</p>
<p><code>package.json</code>파일에서 <code>"scripts"</code> 를 작성하여 필요한 next 명령어를 등록해줍니다.</p>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"next"</span><span class="token operator">:</span> <span class="token string">"^10.0.9"</span><span class="token punctuation">,</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"^17.0.2"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"^17.0.2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"next dev"</span><span class="token punctuation">,</span>
		<span class="token property">"export"</span><span class="token operator">:</span> <span class="token string">"next build &#x26;&#x26; next export"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p><code>npm run dev</code>를 통해 프로젝트를 개발 환경에서 실행할 수 있습니다.
<code>npm run export</code>를 통해 빌드 후 <code>out/</code> 디렉토리에 정적 사이트 리소스를 생성할 수 있습니다.</p>
<h3>기본 폴더 구조 설정</h3>
<p>Next에서 각 url 주소는 <code>pages</code> 폴더 아래의 경로 및 파일과 상응합니다. <code>pages</code>폴더를 생성하고, 그 안에 <code>index.js</code> 파일을 생성해줍니다.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">mkdir</span> pages
<span class="token function">touch</span> pages/index.js
</code></pre></div>
<p><code>pages/index.js</code>는 기본 경로에서 표시할 컴포넌트입니다. 간단한 함수 컴포넌트를 정의하여 제대로 렌더링되는지 확인해보겠습니다.</p>
<div class="remark-highlight"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// pages/index.js</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">HomePage</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">Welcome to Next!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">HomePage</span>
</code></pre></div>
<p>위에서 <code>package.json</code>에 작성한 npm 명령어를 통해 개발 버전으로 확인해보겠습니다.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run dev
</code></pre></div>
<p>터미널에 ready 표시와 함께 출력되는 url을 통해 작성한 Next 앱을 확인할 수 있습니다.</p>
<p><img src="../assets/post-image/Next-js%EB%A1%9C-%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0/run-dev.png" alt="run-dev"></p>
<p>브라우저에서 해당 주소로 접속하면 <code>build page: /</code> 가 출력되고, 해당 컴포넌트를 컴파일해 화면에 보여줍니다.</p>
<p><img src="../assets/post-image/Next-js%EB%A1%9C-%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0/run-dev-success.png" alt="run-dev-success"></p>
<h2>배포</h2>
<p>정적 사이트로 배포하기 위해 <code>next build</code> 를 실행한 뒤 <code>next export</code>를 실행하고, 빌드로 생성된 <code>out/</code> 디렉토리의 파일들을 github pages 호스팅의 소스코드로 사용하도록 하였습니다.</p>
<p>이를 위해 git subtree 기능을 이용하여 <code>gh-pages </code> 브랜치를 생성하고, <code>package.json</code> 파일에서 <code>deploy</code> 명령어를 추가하여 <code>next export</code>와 git subtree 푸시를 한 번에 해결할 수 있도록 하였습니다.</p>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
	<span class="token comment">//...</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"next dev"</span><span class="token punctuation">,</span>
    <span class="token property">"predeploy"</span><span class="token operator">:</span> <span class="token string">"next build &#x26;&#x26; next export"</span><span class="token punctuation">,</span>
    <span class="token property">"deploy"</span><span class="token operator">:</span> <span class="token string">"git add out &#x26;&#x26; git commit -m 'deploy gh pages' &#x26;&#x26; git subtree push --prefix out origin gh-pages"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2>배포 - 트러블슈팅</h2>
<h3>문제</h3>
<p>github pages로 배포해 테스트해보니, <code>index.html</code>이 로드된 후 404 에러와 함께 필요한 리소스를 불러오지 못하는 문제가 발생했습니다.</p>
<h3>해결</h3>
<p>검색을 통해 <code>.nojekyll</code> 파일을 생성해 함께 배포하여 해결할 수 있었습니다. npm 명령어에서 다음과 같이 설정해주었습니다.</p>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
	<span class="token comment">//...</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"next dev"</span><span class="token punctuation">,</span>
    <span class="token property">"predeploy"</span><span class="token operator">:</span> <span class="token string">"next build &#x26;&#x26; next export"</span><span class="token punctuation">,</span>
    <span class="token property">"deploy"</span><span class="token operator">:</span> <span class="token string">"touch out/.nojekyll &#x26;&#x26; git add out &#x26;&#x26; git commit -m 'deploy gh pages' &#x26;&#x26; git subtree push --prefix out origin gh-pages"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3>원인</h3>
<p>Jekyll에서는 <code>_config.yaml</code>이라는 이름의 설정 파일을 사용하며, 이 파일 이외의 언더스코어(_) 로 시작하는 파일과 디렉토리는 무시합니다. Next의 리소스는 <code>_next/</code> 디렉토리에서 불러와야 하므로, <code>.nojekyll</code> 파일이 없으면 github pages에서 Jekyll의 이런 설정을 그대로 사용하여 해당 디렉토리를 무시하기 때문에 발생하는 문제입니다.</p>
<h2>참고자료</h2>
<blockquote>
<p><a href="https://boramyy.github.io/dev/front-end/nextjs/deploy-gh-pages/">Boram Kim님 블로그</a></p>
<p><a href="https://talk.jekyllrb.com/t/jekyll-ignores-files-with-underscores/3909">Jekyllrb 게시글</a></p>
</blockquote>
<h2>markdown 문서 메타 데이터: front-matter</h2>
<p>front-matter는 문서에 대한 메타 데이터로, 아래와 같이 markdown 파일의 맨 앞에 3개의 대시(-)로 감싸 작성합니다.</p>
<div class="remark-highlight"><pre class="language-markdown"><code class="language-markdown"><span class="token front-matter-block"><span class="token punctuation">---</span>
<span class="token font-matter yaml language-yaml"><span class="token key atrule">title</span><span class="token punctuation">:</span> gray<span class="token punctuation">-</span>matter로 front<span class="token punctuation">-</span>matter 파싱하기
<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-03-21</span>
<span class="token key atrule">author</span><span class="token punctuation">:</span> yes<span class="token punctuation">-</span>xodnd</span>
<span class="token punctuation">---</span></span>
</code></pre></div>
<p>이를 파싱하기 위해 <code>gray-matter</code> 라이브러리를 설치하여 사용하였습니다.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> gray-matter
</code></pre></div>
<p><code>/_posts</code> 폴더에 markdown 파일을 생성하고, front-matter 파싱을 테스트하였습니다.
경로를 찾고 파일을 읽어들이기 위해 node.js의 기본 모듈인 <code>fs</code>, <code>path</code>를 사용하였습니다.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// lib/posts.js</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> matter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gray-matter'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> postsPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token method function property-access">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'_posts'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">getPostsGrayMattered</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fileNames <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readdirSync</span><span class="token punctuation">(</span>postsPath<span class="token punctuation">)</span>

  <span class="token keyword">const</span> allPosts <span class="token operator">=</span> fileNames<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">fileName</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>postsPath<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
    <span class="token keyword">const</span> fileContent <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword control-flow">return</span> <span class="token function">matter</span><span class="token punctuation">(</span>fileContent<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">return</span> allPosts
<span class="token punctuation">}</span>
</code></pre></div>
<p><code>getPostsGrayMattered()</code>의 결과는 다음과 같이 반환됩니다.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token string">'gray matter를 통해 front-matter를 파싱할 수 있습니다. '</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">'gray-matter로 front-matter 파싱하기'</span><span class="token punctuation">,</span>
      date<span class="token operator">:</span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">26</span><span class="token maybe-class-name">T00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00.000</span>Z<span class="token punctuation">,</span>
      author<span class="token operator">:</span> <span class="token string">'yes-xodnd'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    isEmpty<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    excerpt<span class="token operator">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div>
<p>front-matter 영역에 작성한 <code>title</code>, <code>date</code>, <code>author</code>가 파싱되어 <code>data</code> 객체로 반환된 것을 확인할 수 있습니다.
front-matter를 제외한 내용은 <code>content</code>에 아직 HTML로 파싱되지 않은 string으로 저장되어 있습니다.</p>
<h2>마크다운 html로 변환하기</h2>
<p>Next 공식 홈페이지의 <a href="https://github.com/vercel/next.js/tree/canary/examples/blog-starter">blog-starter</a> 예시를 따라 <code>remark</code>를 설치해 사용했습니다.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> remark remark-html
</code></pre></div>
<p><code>gray-matter</code>를 이용해 md 문서를 파싱한 반환값의 <code>content</code> 값을 아래 <code>markdownToHtml</code> 함수에 전달합니다.
html 요소로 변환된 문자열 값이 반환됩니다.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// lib/markdownToHtml.js</span>
<span class="token keyword module">import</span> <span class="token imports">remark</span> <span class="token keyword module">from</span> <span class="token string">'remark'</span>
<span class="token keyword module">import</span> <span class="token imports">html</span> <span class="token keyword module">from</span> <span class="token string">'remark-html'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">markdownToHtml</span><span class="token punctuation">(</span><span class="token parameter">markdown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">remark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">process</span><span class="token punctuation">(</span>markdown<span class="token punctuation">)</span>
  <span class="token keyword control-flow">return</span> result<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2>문서 내 코드블록 파싱 및 하이라이트</h2>
<p>기술 블로그이기 때문에, 마크다운 문서 내에 많은 코드를 작성하게 됩니다.</p>
<p>이를 읽기 좋게 하이라이트 하려면 우선 코드블록 내 문자열을 분류하고, 스타일을 적용할 수 있도록 특정 태그로 감싸줍니다. 여러 라이브러리를 이용할 수 있으나, 코드 하이라이트 라이브러리 <code>prism</code>의 <code>remark</code> 호환버전인 <code>remark-prism</code>을 이용하였습니다.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// lib/markdown.js</span>
<span class="token keyword module">import</span> <span class="token imports">remark</span> <span class="token keyword module">from</span> <span class="token string">'remark'</span>
<span class="token keyword module">import</span> <span class="token imports">html</span> <span class="token keyword module">from</span> <span class="token string">'remark-html'</span>
<span class="token keyword module">import</span> <span class="token imports">prism</span> <span class="token keyword module">from</span> <span class="token string">'remark-prism'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">markdownToHtml</span><span class="token punctuation">(</span><span class="token parameter">markdown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">remark</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>prism<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">process</span><span class="token punctuation">(</span>markdown<span class="token punctuation">)</span>
  <span class="token keyword control-flow">return</span> result<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
</article></section></main><footer class="Footer__Container-qhytvz-0 eHAsYS"><div class="Footer__Content-qhytvz-1 bUsZOM">ⓒ2021 ALL RIGHTS RESERVED</div></footer><button class="ButtonScrollUp__Button-sc-1ue24uv-0 koMWLo"><img src="../../assets/icon/up.svg" alt="up" title="맨 위로"/></button></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"next.js로 마크다운 블로그 구현하기","date":"2021-04-11T00:00:00.000Z","content":"\u003cp\u003e기술 블로그를 운영하기 위해 여러가지 서비스를 찾아다니다가, github pages를 통해 호스팅되는 개발자 블로그를 많이 보게 되었습니다. Jekyll이라는 정적 사이트 생성기를 이용하면 5분 만에 블로그를 만들 수 있다는 글들이 많아 혹했으나, 프론트엔드 개발자로서 직접 만들어보고 싶다는 생각을 하게 되었습니다.\u003c/p\u003e\n\u003cp\u003eNext를 이용하면 마크다운 정적 블로그를 구현할 수 있다는 것을 알게 되어 이번 기회에 학습과 토이 프로젝트 진행, 기술 블로그 제작까지 세 마리 토끼를 한 번에 잡아보고자 하였습니다.\u003c/p\u003e\n\u003ch2\u003e초기 설정\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ecreate-next-app\u003c/code\u003e을 사용하지 않고, 필요한 요소들을 하나씩 manual setup을 해보기로 했습니다.\r\n\u003ccode\u003enext.config.js\u003c/code\u003e 파일이 없지만 next에서 기본 설정을 사용합니다.\u003c/p\u003e\n\u003ch3\u003enpm 패키지 설치\u003c/h3\u003e\n\u003cp\u003eNext 공식 홈페이지의 설명을 따라 React와 Next를 설치합니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003enpm\u003c/span\u003e \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e next react react-dom\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e프로젝트 폴더에는 \u003ccode\u003enode-modules\u003c/code\u003e폴더와 \u003ccode\u003epackage.json\u003c/code\u003e, \u003ccode\u003epackage-lock.json\u003c/code\u003e 두 개의 기본적인 json 파일이 생성되었습니다.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epackage.json\u003c/code\u003e파일에서 \u003ccode\u003e\"scripts\"\u003c/code\u003e 를 작성하여 필요한 next 명령어를 등록해줍니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token comment\"\u003e// package.json\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"dependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"next\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^10.0.9\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"react\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^17.0.2\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"react-dom\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^17.0.2\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"dev\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"next dev\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\u003cspan class=\"token property\"\u003e\"export\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"next build \u0026#x26;\u0026#x26; next export\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003enpm run dev\u003c/code\u003e를 통해 프로젝트를 개발 환경에서 실행할 수 있습니다.\r\n\u003ccode\u003enpm run export\u003c/code\u003e를 통해 빌드 후 \u003ccode\u003eout/\u003c/code\u003e 디렉토리에 정적 사이트 리소스를 생성할 수 있습니다.\u003c/p\u003e\n\u003ch3\u003e기본 폴더 구조 설정\u003c/h3\u003e\n\u003cp\u003eNext에서 각 url 주소는 \u003ccode\u003epages\u003c/code\u003e 폴더 아래의 경로 및 파일과 상응합니다. \u003ccode\u003epages\u003c/code\u003e폴더를 생성하고, 그 안에 \u003ccode\u003eindex.js\u003c/code\u003e 파일을 생성해줍니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003emkdir\u003c/span\u003e pages\n\u003cspan class=\"token function\"\u003etouch\u003c/span\u003e pages/index.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003epages/index.js\u003c/code\u003e는 기본 경로에서 표시할 컴포넌트입니다. 간단한 함수 컴포넌트를 정의하여 제대로 렌더링되는지 확인해보겠습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-jsx\"\u003e\u003ccode class=\"language-jsx\"\u003e\u003cspan class=\"token comment\"\u003e// pages/index.js\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eHomePage\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token plain-text\"\u003eWelcome to Next!\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eHomePage\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e위에서 \u003ccode\u003epackage.json\u003c/code\u003e에 작성한 npm 명령어를 통해 개발 버전으로 확인해보겠습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003enpm\u003c/span\u003e run dev\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e터미널에 ready 표시와 함께 출력되는 url을 통해 작성한 Next 앱을 확인할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../assets/post-image/Next-js%EB%A1%9C-%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0/run-dev.png\" alt=\"run-dev\"\u003e\u003c/p\u003e\n\u003cp\u003e브라우저에서 해당 주소로 접속하면 \u003ccode\u003ebuild page: /\u003c/code\u003e 가 출력되고, 해당 컴포넌트를 컴파일해 화면에 보여줍니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../assets/post-image/Next-js%EB%A1%9C-%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0/run-dev-success.png\" alt=\"run-dev-success\"\u003e\u003c/p\u003e\n\u003ch2\u003e배포\u003c/h2\u003e\n\u003cp\u003e정적 사이트로 배포하기 위해 \u003ccode\u003enext build\u003c/code\u003e 를 실행한 뒤 \u003ccode\u003enext export\u003c/code\u003e를 실행하고, 빌드로 생성된 \u003ccode\u003eout/\u003c/code\u003e 디렉토리의 파일들을 github pages 호스팅의 소스코드로 사용하도록 하였습니다.\u003c/p\u003e\n\u003cp\u003e이를 위해 git subtree 기능을 이용하여 \u003ccode\u003egh-pages \u003c/code\u003e 브랜치를 생성하고, \u003ccode\u003epackage.json\u003c/code\u003e 파일에서 \u003ccode\u003edeploy\u003c/code\u003e 명령어를 추가하여 \u003ccode\u003enext export\u003c/code\u003e와 git subtree 푸시를 한 번에 해결할 수 있도록 하였습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token comment\"\u003e// package.json\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e//...\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token property\"\u003e\"dev\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"next dev\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"predeploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"next build \u0026#x26;\u0026#x26; next export\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"deploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"git add out \u0026#x26;\u0026#x26; git commit -m 'deploy gh pages' \u0026#x26;\u0026#x26; git subtree push --prefix out origin gh-pages\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003e배포 - 트러블슈팅\u003c/h2\u003e\n\u003ch3\u003e문제\u003c/h3\u003e\n\u003cp\u003egithub pages로 배포해 테스트해보니, \u003ccode\u003eindex.html\u003c/code\u003e이 로드된 후 404 에러와 함께 필요한 리소스를 불러오지 못하는 문제가 발생했습니다.\u003c/p\u003e\n\u003ch3\u003e해결\u003c/h3\u003e\n\u003cp\u003e검색을 통해 \u003ccode\u003e.nojekyll\u003c/code\u003e 파일을 생성해 함께 배포하여 해결할 수 있었습니다. npm 명령어에서 다음과 같이 설정해주었습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token comment\"\u003e// package.json\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e//...\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"dev\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"next dev\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"predeploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"next build \u0026#x26;\u0026#x26; next export\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"deploy\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"touch out/.nojekyll \u0026#x26;\u0026#x26; git add out \u0026#x26;\u0026#x26; git commit -m 'deploy gh pages' \u0026#x26;\u0026#x26; git subtree push --prefix out origin gh-pages\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003e원인\u003c/h3\u003e\n\u003cp\u003eJekyll에서는 \u003ccode\u003e_config.yaml\u003c/code\u003e이라는 이름의 설정 파일을 사용하며, 이 파일 이외의 언더스코어(_) 로 시작하는 파일과 디렉토리는 무시합니다. Next의 리소스는 \u003ccode\u003e_next/\u003c/code\u003e 디렉토리에서 불러와야 하므로, \u003ccode\u003e.nojekyll\u003c/code\u003e 파일이 없으면 github pages에서 Jekyll의 이런 설정을 그대로 사용하여 해당 디렉토리를 무시하기 때문에 발생하는 문제입니다.\u003c/p\u003e\n\u003ch2\u003e참고자료\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://boramyy.github.io/dev/front-end/nextjs/deploy-gh-pages/\"\u003eBoram Kim님 블로그\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://talk.jekyllrb.com/t/jekyll-ignores-files-with-underscores/3909\"\u003eJekyllrb 게시글\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003emarkdown 문서 메타 데이터: front-matter\u003c/h2\u003e\n\u003cp\u003efront-matter는 문서에 대한 메타 데이터로, 아래와 같이 markdown 파일의 맨 앞에 3개의 대시(-)로 감싸 작성합니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-markdown\"\u003e\u003ccode class=\"language-markdown\"\u003e\u003cspan class=\"token front-matter-block\"\u003e\u003cspan class=\"token punctuation\"\u003e---\u003c/span\u003e\n\u003cspan class=\"token font-matter yaml language-yaml\"\u003e\u003cspan class=\"token key atrule\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e gray\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003ematter로 front\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003ematter 파싱하기\n\u003cspan class=\"token key atrule\"\u003edate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token datetime number\"\u003e2021-03-21\u003c/span\u003e\n\u003cspan class=\"token key atrule\"\u003eauthor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e yes\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003exodnd\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e---\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e이를 파싱하기 위해 \u003ccode\u003egray-matter\u003c/code\u003e 라이브러리를 설치하여 사용하였습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003enpm\u003c/span\u003e \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e gray-matter\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003e/_posts\u003c/code\u003e 폴더에 markdown 파일을 생성하고, front-matter 파싱을 테스트하였습니다.\r\n경로를 찾고 파일을 읽어들이기 위해 node.js의 기본 모듈인 \u003ccode\u003efs\u003c/code\u003e, \u003ccode\u003epath\u003c/code\u003e를 사용하였습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// lib/posts.js\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e fs \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'fs'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e path \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'path'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e matter \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'gray-matter'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e postsPath \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e path\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejoin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprocess\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecwd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'_posts'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003egetPostsGrayMattered\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e fileNames \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fs\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereaddirSync\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epostsPath\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e allPosts \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fileNames\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003efileName\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e filePath \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e path\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejoin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epostsPath\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fileName\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e fileContent \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fs\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereadFileSync\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efilePath\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'utf-8'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003ematter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efileContent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e allPosts\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003egetPostsGrayMattered()\u003c/code\u003e의 결과는 다음과 같이 반환됩니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    content\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'gray matter를 통해 front-matter를 파싱할 수 있습니다. '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    data\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      title\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'gray-matter로 front-matter 파싱하기'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      date\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e2021\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e03\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e26\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eT00\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e00\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e00.000\u003c/span\u003eZ\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      author\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'yes-xodnd'\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    isEmpty\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    excerpt\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e''\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003efront-matter 영역에 작성한 \u003ccode\u003etitle\u003c/code\u003e, \u003ccode\u003edate\u003c/code\u003e, \u003ccode\u003eauthor\u003c/code\u003e가 파싱되어 \u003ccode\u003edata\u003c/code\u003e 객체로 반환된 것을 확인할 수 있습니다.\r\nfront-matter를 제외한 내용은 \u003ccode\u003econtent\u003c/code\u003e에 아직 HTML로 파싱되지 않은 string으로 저장되어 있습니다.\u003c/p\u003e\n\u003ch2\u003e마크다운 html로 변환하기\u003c/h2\u003e\n\u003cp\u003eNext 공식 홈페이지의 \u003ca href=\"https://github.com/vercel/next.js/tree/canary/examples/blog-starter\"\u003eblog-starter\u003c/a\u003e 예시를 따라 \u003ccode\u003eremark\u003c/code\u003e를 설치해 사용했습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003enpm\u003c/span\u003e \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e remark remark-html\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003egray-matter\u003c/code\u003e를 이용해 md 문서를 파싱한 반환값의 \u003ccode\u003econtent\u003c/code\u003e 값을 아래 \u003ccode\u003emarkdownToHtml\u003c/code\u003e 함수에 전달합니다.\r\nhtml 요소로 변환된 문자열 값이 반환됩니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// lib/markdownToHtml.js\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003eremark\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'remark'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003ehtml\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'remark-html'\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emarkdownToHtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003emarkdown\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003eremark\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003euse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ehtml\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eprocess\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emarkdown\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e result\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003e문서 내 코드블록 파싱 및 하이라이트\u003c/h2\u003e\n\u003cp\u003e기술 블로그이기 때문에, 마크다운 문서 내에 많은 코드를 작성하게 됩니다.\u003c/p\u003e\n\u003cp\u003e이를 읽기 좋게 하이라이트 하려면 우선 코드블록 내 문자열을 분류하고, 스타일을 적용할 수 있도록 특정 태그로 감싸줍니다. 여러 라이브러리를 이용할 수 있으나, 코드 하이라이트 라이브러리 \u003ccode\u003eprism\u003c/code\u003e의 \u003ccode\u003eremark\u003c/code\u003e 호환버전인 \u003ccode\u003eremark-prism\u003c/code\u003e을 이용하였습니다.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// lib/markdown.js\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003eremark\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'remark'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003ehtml\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'remark-html'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003eprism\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'remark-prism'\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emarkdownToHtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003emarkdown\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003eremark\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003euse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ehtml\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003euse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprism\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eprocess\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emarkdown\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e result\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n","slug":"Next-js로-마크다운-블로그-구현하기"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"Next-js로-마크다운-블로그-구현하기"},"buildId":"MjomxLEJg3bhdc3G2QbSf","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/main-f187076f129739963abb.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.e3de07479da4f2477dea.js" async=""></script><script src="/_next/static/chunks/365e2c93ee4512644b764144cea69ab374a79a06.3b920c3faddc10506db9.js" async=""></script><script src="/_next/static/chunks/24220ea1bbf29512b490391fd78ed8994ffe83b7.e749a8624d972ec43ecc.js" async=""></script><script src="/_next/static/chunks/pages/_app-45233f10ca9edf78efdb.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-34016f798fe4617dc9a3.js" async=""></script><script src="/_next/static/MjomxLEJg3bhdc3G2QbSf/_buildManifest.js" async=""></script><script src="/_next/static/MjomxLEJg3bhdc3G2QbSf/_ssgManifest.js" async=""></script></body></html>